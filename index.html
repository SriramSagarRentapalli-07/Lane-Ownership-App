<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lane Ownership Pro - WORKING</title>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBEbLeeT2G2czmJ5JMTckUj6qZJ3oqXg7k&libraries=places"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { background: #0f0f23; color: white; font-family: 'Arial', sans-serif; }
        .glass { background: rgba(255,255,255,0.1); backdrop-filter: blur(20px); border-radius: 20px; padding: 20px; margin: 10px; }
        #map { height: 500px; border-radius: 20px; margin: 10px; }
        input, select { background: rgba(0,0,0,0.5); color: white; border: 1px solid white; padding: 15px; border-radius: 10px; font-size: 16px; width: 100%; margin: 5px 0; }
        input:focus, select:focus { outline: none; border-color: #10B981; }
        button { background: linear-gradient(45deg, #10B981, #34D399); color: white; border: none; padding: 15px 30px; border-radius: 10px; font-size: 16px; cursor: pointer; margin: 5px; }
        button:hover { transform: scale(1.05); }
        .car { width: 50px; height: 25px; border-radius: 25px; margin: 5px; }
        .maruti { background: #10B981; }
        .tata { background: #F59E0B; }
        .hyundai { background: #3B82F6; }
    </style>
</head>
<body>
    <div id="login" style="position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.9);display:flex;align-items:center;justify-content:center;z-index:1000;">
        <div class="glass" style="width:90%;max-width:500px;">
            <h1 style="text-align:center;font-size:2.5em;color:#10B981;margin-bottom:20px;">üöó Vehicle Login</h1>
            
            <div class="glass" style="margin-bottom:20px;">
                <h3>üìç GPS Location</h3>
                <button onclick="setDelhi()">Delhi Demo</button>
                <button onclick="setMumbai()">Mumbai Demo</button>
                <p id="gpsInfo">Click GPS button first</p>
            </div>
            
            <input id="reg" placeholder="MH04AB1234">
            <select id="company" onchange="updateTypes()">
                <option value="">Select Company</option>
                <option value="maruti">Maruti</option>
                <option value="tata">Tata</option>
                <option value="hyundai">Hyundai</option>
            </select>
            <select id="type" disabled>
                <option value="">Vehicle Type</option>
            </select>
            <select id="model" disabled>
                <option value="">Model</option>
            </select>
            
            <button onclick="startApp()">üöÄ START TRACKING</button>
        </div>
    </div>

    <div id="app" style="display:none;">
        <div style="text-align:center;padding:20px;">
            <h1 style="font-size:3em;color:#10B981;">Lane Ownership Pro</h1>
            <div style="display:flex;justify-content:center;align-items:center;">
                <div id="carPreview" class="car maruti" style="margin-right:20px;"></div>
                <div>
                    <div id="carInfo" style="font-size:1.5em;margin-bottom:5px;">-</div>
                    <div id="liveCount" style="color:#10B981;font-size:1.2em;">24,847 Live Vehicles</div>
                </div>
            </div>
            <button onclick="logout()" style="background:#ef4444;">Logout</button>
        </div>

        <div style="display:flex;flex-wrap:wrap;">
            <div class="glass" style="flex:1;min-width:400px;">
                <h2>üó∫Ô∏è Live Map</h2>
                <div id="map"></div>
                <button onclick="centerCar()">üìç Center Car</button>
                <button onclick="clearRoute()">üóëÔ∏è Clear Route</button>
            </div>
            
            <div class="glass" style="flex:1;min-width:300px;">
                <h2>üß≠ Route Planner</h2>
                <p><strong>Start:</strong> <span id="startPos">-</span></p>
                <input id="dest" placeholder="Type Mumbai, Delhi, Pune..." style="margin:10px 0;">
                <div style="display:flex;">
                    <div style="flex:1;margin-right:10px;">
                        <div id="dist">-</div>
                        <div style="font-size:0.8em;">Distance</div>
                    </div>
                    <div style="flex:1;">
                        <div id="time">-</div>
                        <div style="font-size:0.8em;">ETA</div>
                    </div>
                </div>
                <button onclick="getRoute()">Calculate Route</button>
            </div>
        </div>
    </div>

    <script>
        let map, marker, route, loc = {lat: 28.6139, lng: 77.2090};
        let carData = null;
        
        const cars = {
            maruti: {name:"Maruti", types:{hatchback:["Swift"], suv:["Brezza"]}},
            tata: {name:"Tata", types:{hatchback:["Punch"], suv:["Nexon"]}},
            hyundai: {name:"Hyundai", types:{suv:["Creta"]}}
        };
        
        function updateTypes() {
            const company = document.getElementById('company').value;
            const typeSelect = document.getElementById('type');
            typeSelect.innerHTML = '<option value="">Type</option>';
            typeSelect.disabled = !company;
            if (cars[company]) {
                Object.keys(cars[company].types).forEach(t => {
                    typeSelect.innerHTML += `<option value="${t}">${t}</option>`;
                });
            }
        }
        
        function updateModels() {
            const company = document.getElementById('company').value;
            const type = document.getElementById('type').value;
            const modelSelect = document.getElementById('model');
            modelSelect.innerHTML = '<option value="">Model</option>';
            modelSelect.disabled = !type || !company;
            if (cars[company]?.types[type]) {
                cars[company].types[type].forEach(m => {
                    modelSelect.innerHTML += `<option value="${m}">${m}</option>`;
                });
            }
        }
        
        document.getElementById('type').onchange = updateModels;
        
        function setDelhi() {
            loc = {lat: 28.6139, lng: 77.2090};
            document.getElementById('gpsInfo').innerText = 'Delhi: 28.6139, 77.2090 ‚úì';
        }
        
        function setMumbai() {
            loc = {lat: 19.0760, lng: 72.8774};
            document.getElementById('gpsInfo').innerText = 'Mumbai: 19.0760, 72.8774 ‚úì';
        }
        
        function startApp() {
            const reg = document.getElementById('reg').value;
            const company = document.getElementById('company').value;
            const type = document.getElementById('type').value;
            const model = document.getElementById('model').value;
            
            if (!reg || !company || !type || !model) {
                alert('Fill everything!');
                return;
            }
            
            carData = {
                reg, company, type, model,
                name: `${cars[company].name} ${model}`,
                color: company
            };
            
            document.getElementById('carInfo').innerText = carData.name + ' ‚Ä¢ ' + reg;
            document.getElementById('carPreview').className = `car ${carData.color}`;
            document.getElementById('startPos').innerText = `${loc.lat.toFixed(4)}, ${loc.lng.toFixed(4)}`;
            
            document.getElementById('login').style.display = 'none';
            document.getElementById('app').style.display = 'block';
            
            setTimeout(() => {
                initMap();
                setInterval(() => {
                    document.getElementById('liveCount').innerText = (Math.floor(Math.random()*5000)+24000) + ' Live Vehicles';
                }, 2000);
            }, 500);
        }
        
        function initMap() {
            map = L.map('map').setView([loc.lat, loc.lng], 13);
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);
            
            const carIcon = L.divIcon({
                html: `<div class="car ${carData.color}" style="width:50px;height:25px;transform:rotate(45deg);"></div>`,
                iconSize: [50, 25], iconAnchor: [25, 25], className: ''
            });
            
            marker = L.marker([loc.lat, loc.lng], {icon: carIcon}).addTo(map)
                .bindPopup(carData.name + '<br>' + carData.reg);
        }
        
        function getRoute() {
            const dest = document.getElementById('dest').value;
            if (!dest) return alert('Type destination!');
            
            if (route) map.removeLayer(route);
            
            new google.maps.DirectionsService().route({
                origin: new google.maps.LatLng(loc.lat, loc.lng),
                destination: dest,
                travelMode: google.maps.TravelMode.DRIVING
            }, (res, status) => {
                if (status == 'OK') {
                    const r = res.routes[0].legs[0];
                    document.getElementById('dist').innerText = r.distance.text;
                    document.getElementById('time').innerText = r.duration.text;
                    
                    const path = res.routes[0].overview_path.map(p => [p.lat(), p.lng()]);
                    route = L.polyline(path, {color: getColor(carData.company), weight: 6}).addTo(map);
                    map.fitBounds(route.getBounds());
                } else {
                    alert('Try Mumbai, Delhi, Pune, Bangalore');
                }
            });
        }
        
        function getColor(c) {
            const colors = {maruti:'#10B981', tata:'#F59E0B', hyundai:'#3B82F6'};
            return colors[c] || '#10B981';
        }
        
        function centerCar() { map.setView(marker.getLatLng(), 16); }
        function clearRoute() { 
            if (route) map.removeLayer(route); 
            route = null;
            document.getElementById('dist').innerText = '-';
            document.getElementById('time').innerText = '-';
        }
        function logout() {
            document.getElementById('app').style.display = 'none';
            document.getElementById('login').style.display = 'flex';
        }
    </script>
</body>
</html>
